var port=8810,fs=require("fs"),path=require("path"),qs=require("querystring"),server=require("http").createServer(function(e,t){var s,o,a,n,r=e.url;if(-1!=r.indexOf("?")&&(s=r.substring(r.indexOf("?")+1),r=r.substring(0,r.indexOf("?"))),"/TestBox/AJAX_TEST"===r)"GET"===e.method.toUpperCase()?console.log("TestBox",e.method.toUpperCase(),qs.parse(s)):(e.on("data",function(e){void 0===s&&(s=""),s+=e}),e.on("end",function(){console.log("TestBox",e.method.toUpperCase(),qs.parse(s))})),t.end("TestBox request DONE!");else if("/TestBox/AJAX_JSON_TEST"===r)"GET"===e.method.toUpperCase()?console.log("TestBox",e.method.toUpperCase(),qs.parse(s)):(e.on("data",function(e){void 0===s&&(s=""),s+=e}),e.on("end",function(){console.log("TestBox",e.method.toUpperCase(),qs.parse(s))})),t.end('{ "BOX" : "TestBox", "thisis" : "JSON" }');else{switch("/"===r&&(r="/TEST.html"),o="./"+r,a=path.extname(o)){case".js":n="text/javascript";break;case".css":n="text/css";break;case".jpg":case".jpeg":n="image/jpeg";break;case".png":n="image/png";break;case".swf":n="application/x-shockwave-flash";break;case".html":n="text/html";break;case".mp3":n="audio/mpeg";break;default:n="application/octet-stream"}fs.exists(o,function(e){e===!0?fs.readFile(o,"binary",function(e,s){null===e?(t.writeHead(200,{"Content-Type":n}),t.write(s,"binary"),t.end()):(t.writeHead(500,{"Content-Type":"text/plain"}),t.write(e),t.end())}):(t.writeHead(404,{"Content-Type":"text/plain"}),t.write("404 Not Found."),t.end())})}});server.listen(port),console.log("UPPERCASE.IO-BOX test server running. - http://localhost:"+port);