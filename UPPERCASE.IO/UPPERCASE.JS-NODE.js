global.NODE_CONFIG=NODE_CONFIG={},global.CPU_CLUSTERING=CPU_CLUSTERING=METHOD({run:function(t,e){"use strict";var o=require("cluster");RUN(o.isMaster?function(){var t=function(){var t=o.fork();t.on("message",function(e){EACH(o.workers,function(o){o!==t&&o.send(e)})})};REPEAT(require("os").cpus().length,function(){t()}),o.on("exit",function(e,o,n){console.log("[UPPERCASE.JS-CLUSTERING] WORKER #"+e.id+" (PID:"+e.process.pid+") died. ("+(void 0!==n?n:o)+"). restarting..."),t()})}:function(){var n={},r=function(t,e){n[t]=e};process.on("message",function(t){var e=t.methodName,o=t.data,r=n[e];void 0!==r&&r(o)}),r("__SHARED_STORE_SAVE",function(t){var e=t.fullKey,o=t.value;SHARED_STORE.storage[e]=o}),r("__SHARED_STORE_REMOVE",function(t){delete SHARED_STORE.storage[t]}),e({id:o.worker.id,pid:o.worker.process.pid},r,t.broadcast=function(t){process.send(t)})})}}),global.SERVER_CLUSTERING=SERVER_CLUSTERING=METHOD({run:function(t,e){"use strict";var o,n=require("os"),r=n.networkInterfaces(),E=[];EACH(r,function(t){return EACH(t,function(t){var n=t.address;return"IPv4"===t.family&&t.internal===!1&&(E.push(n),CHECK_IS_EXISTS({data:e,value:n})===!0)?(o=n,!1):void 0})}),void 0===o?console.log("[UPPERCASE.JS-SERVER_CLUSTERING] NOT EXISTS MY HOST: (SERVER HOSTS:",e,", MY HOSTS:",E):console.log("[UPPERCASE.JS-SERVER_CLUSTERING] RUNNING CLUSTERING SERVER... (MY HOST:"+o+")")}}),global.SHARED_STORE=SHARED_STORE=CLASS({statics:function(t){"use strict";t.storage={}},init:function(t,e,o,n){"use strict";var r,E,i,a,s=t.storage;r=function(t){return n+"."+t},o.save=E=function(t){var e=t.key,o=r(e),n=t.value;s[o]=n,void 0!==CLUSTERING.broadcast&&CLUSTERING.broadcast({methodName:"__SHARED_STORE_SAVE",data:{fullKey:o,value:n}})},o.get=i=function(t){return s[r(t)]},o.remove=a=function(t){var e=r(t);delete s[e],void 0!==CLUSTERING.broadcast&&CLUSTERING.broadcast({methodName:"__SHARED_STORE_REMOVE",data:e})}}}),global.CONNECT_TO_SOCKET_SERVER=CONNECT_TO_SOCKET_SERVER=METHOD({run:function(t,e,o){"use strict";var n=e.host,r=e.port,E=require("net"),i={},a=E.connect({host:n,port:r},function(){o(function(t,e){i[t]=e},function(t){a.write(STRINGIFY(t))})});a.on("data",function(t){var e=PARSE_STR(t.toString()),o=e.methodName,n=e.data,r=i[o];void 0!==r&&r(n)})}}),global.SHA1=SHA1=METHOD({run:function(t,e){"use strict";var o=e.key,n=e.password,r=require("crypto");return r.createHmac("sha1",o).update(n).digest("hex")}}),global.DELETE=DELETE=METHOD({run:function(t,e,o){"use strict";REQUEST(COMBINE_DATA({origin:e,extend:{method:"DELETE"}}),o)}}),global.GET=GET=METHOD({run:function(t,e,o){"use strict";REQUEST(COMBINE_DATA({origin:e,extend:{method:"GET"}}),o)}}),global.POST=POST=METHOD({run:function(t,e,o){"use strict";REQUEST(COMBINE_DATA({origin:e,extend:{method:"POST"}}),o)}}),global.PUT=PUT=METHOD({run:function(t,e,o){"use strict";REQUEST(COMBINE_DATA({origin:e,extend:{method:"PUT"}}),o)}}),global.REQUEST=REQUEST=METHOD({run:function(t,e,o){"use strict";var n,r=require("http"),E=void 0===e.host?"localhost":e.host,i=void 0===e.port?80:e.port,a=e.uri,s=void 0!==e.data?"data="+encodeURIComponent(STRINGIFY(e.data)):e.paramStr,S=e.method;s=(void 0===s?"":s+"&")+Date.now(),S=S.toUpperCase(),"GET"===S?n=r.get({hostname:E,port:i,path:"/"+a+"?"+s},function(t){t.setEncoding("utf-8"),t.on("data",function(t){o(t)})}):(n=r.request({hostname:E,port:i,path:"/"+a,method:S},function(t){t.setEncoding("utf-8"),t.on("data",function(t){o(t)})}),n.write(s),n.end()),n.on("error",function(t){console.log("[UPPERCASE.JS-NODE] REQUEST FAILED:",e,t)})}}),global.SOCKET_SERVER=SOCKET_SERVER=METHOD({run:function(t,e,o){"use strict";var n=require("net"),r=n.createServer(function(t){var e={};t.on("data",function(t){var o=PARSE_STR(t.toString()),n=o.methodName,r=o.data,E=e[n];void 0!==E&&E(r)}),o({ip:t.remoteAddress,port:t.remotePort},function(t,o){e[t]=o},function(e){t.write(STRINGIFY(e))})});r.listen(e),console.log("[UPPERCASE.JS-SOCKET_SERVER] RUNNING SOCKET SERVER... (PORT:"+e+")")}}),global.WEB_SERVER=WEB_SERVER=METHOD({run:function(t,e,o){"use strict";var n=require("http");require("https"),n.createServer(function(t,e){var n=t.headers["X-Forwarded-For"];void 0===n&&(n=t.connection.remoteAddress),o({ip:n,headers:t.headers,nativeReq:t},function(t){var o=void 0===t.statusCode?200:t.statusCode,n=void 0===t.headers?{}:t.headers,r=t.contentType,E=t.content,i=void 0===t.encoding?"utf-8":i,a=t.cacheTime;void 0!==r&&(n["Content-Type"]=contentTypes),void 0!==a&&(n.ETag=a,n["Last-Modified"]=new Date(a).toUTCString()),e.writeHead(o,n),e.end(E)})}).listen(e),console.log("[UPPERCASE.JS-WEB_SERVER] RUNNING WEB SERVER... (PORT:"+e+")")}});